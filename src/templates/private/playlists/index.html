{% extends 'bases/private.html' %}

{% block content %}
<div class="container has-nav">
    <div class="header">
        <div class="header-content">
            <div>
                <h1>Your Playlists</h1>
                <p class="tagline">Organize your music</p>
            </div>
            <button id="open-create-playlist-modal" class="btn btn-secondary">Create Playlist</button>
        </div>
    </div>

    <div class="content-section">
        <div class="playlists-grid">
            {% for playlist in playlists %}
            <div class="playlist-card">
                <div class="playlist-card-header">
                    <h3>{{ playlist.name }}</h3>
                    {% if playlist.is_public %}
                    <span class="badge badge-public">Public</span>
                    {% else %}
                    <span class="badge badge-private">Private</span>
                    {% endif %}
                </div>
                
                {% if playlist.description %}
                <p class="playlist-description">{{ playlist.description }}</p>
                {% endif %}
                
                <div class="playlist-meta">
                    <span>{{ playlist.songs|length }} songs</span>
                    <span>â€¢</span>
                    <span>Updated {{ playlist.updated_at.strftime('%b %d, %Y') }}</span>
                </div>
                
                <div class="playlist-actions">
                    <a href="{{ url_for('playlists.view_playlist', playlist_id=playlist.id) }}" class="btn btn-sm btn-primary">View</a>
                    <form method="POST" action="{{ url_for('playlists.delete_playlist', playlist_id=playlist.id) }}" style="margin: 0;" onsubmit="return confirm('Are you sure you want to delete this playlist?');">
                        <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                    </form>
                </div>
            </div>
            {% else %}
            <div class="empty-state">
                <p>No playlists yet. Create your first playlist!</p>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Create Playlist Modal -->
{% from 'components/modal/modal.html' import modal %}
{% call modal('create-playlist', 'Create Playlist', 'md') %}
{% include 'private/playlists/forms/create.html' %}
{% endcall %}

<script>
document.addEventListener('DOMContentLoaded', () => {
    const openModalBtn = document.getElementById('open-create-playlist-modal');
    const modalOverlay = document.getElementById('create-playlist-overlay');
    const closeModalBtn = modalOverlay ? modalOverlay.querySelector('.modal-close') : null;

    if (openModalBtn && modalOverlay) {
        // Open modal
        openModalBtn.addEventListener('click', () => {
            modalOverlay.classList.add('active');
        });

        // Close modal
        if (closeModalBtn) {
            closeModalBtn.addEventListener('click', () => {
                modalOverlay.classList.remove('active');
            });
        }

        // Close when clicking outside
        modalOverlay.addEventListener('click', (e) => {
            if (e.target === modalOverlay) {
                modalOverlay.classList.remove('active');
            }
        });
    }
});
</script>
{% endblock content %}
